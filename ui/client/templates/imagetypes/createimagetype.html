{% extends 'index.html' %}

{% block title %}{% if imagetype %} Edit image type: {{imagetype.name}} {% else %}Create an image type{% endif %}{% endblock %}

{% block header %}
    {% include "page-header.html" %}
{% endblock %}

{% block content %}
    <div id="content-body" class="page-create-image-type">
      <div id="title">
        <div class="pull-right">
          <div id="global">
            {% include "imagetypes/topmenu.html" %}
          </div>
        </div>
        <div style="clear: both"></div>
      </div>

      <div id="panels">

        <div class="panel spl-panel" style="clear: both;">
          <div class="panel-head spl-panel-head edit-template clearfix">
            <div class="panel-title spl-panel-title"><h3 class="pull-left">{% if imagetype %} Edit image type: {{imagetype.name}} {% else %}Create a image type{% endif %}</h3>
            <div class="pull-right">
              {% if imagetype %}
              <form role="form" method="POST" action="/imagetypes/delete/{{imagetype.name}}" class="imagetype-delete-form">
                <input type="hidden" value="{{imagetype.name}}" name="name" />
                <button type="submit" class="btn-spl btn-delete"></button>
              </form>
              {% endif %}
            </div>
            </div>
          </div>

          <div class="panel-body spl-panel-body">
            <form class="form-horizontal" role="form" id="create-imagetype-form" action="{% if imagetype %}/imagetypes/update{% else %}/imagetypes/create{% endif %}">
              <div class="form-group">
                <label for="inputName" class="col-sm-2 control-label">Name</label>
                <div class="col-sm-8">
                  <input type="text" class="form-control" id="inputName" name="inputName" placeholder="Name" value="{{imagetype.name}}" {% if imagetype %} disabled {% endif %}>
                </div>
              </div>
              <div class="form-group">
                <label for="inputDescription" class="col-sm-2 control-label">Description</label>
                <div class="col-sm-8">
                  <input type="text" class="form-control" id="inputDescription" name="inputDescription" placeholder="Description" value="{{imagetype.description}}">
                </div>
              </div>
              <h4>Providers</h4>
              <div class="form-group provider-entries">
                {% if imagetype.providermap %}
                  {% for item in imagetype.providermap %}
                  <div class="provider-entry">
                    <div class="col-sm-offset-2 col-sm-2">
                      <select class="form-control" name="inputProvider">
                        <option selected="selected">{{loop.key}}</option>
                        {% set currentProvider = loop.key %}
                        {% for entry in providers  %}
                          {% if entry.name !== currentProvider %}
                            <option>{{ entry.name }}</option>
                          {% endif %}
                        {% endfor %}
                      </select>
                    </div>
                    <div class="col-sm-4">
                      <input type="text" class="form-control" name="inputImage" placeholder="Image" value="{{item.image}}">
                    </div>
                    <div class="col-sm-2">
                      <input type="text" class="form-control" name="inputSshuser" placeholder="SSH User" value="{{item.sshuser}}">
                    </div>
                  </div>
                  {% endfor %}
                {% else %}
                  <div class="provider-entry">
                    <div class="col-sm-offset-2 col-sm-2">
                      <select class="form-control" name="inputProvider">
                        <option selected="selected"></option>
                        {% for entry in providers  %}
                        <option>{{ entry.name }}</option>
                        {% endfor %}
                      </select>
                    </div>
                    <div class="col-sm-4">
                      <input type="text" class="form-control" name="inputImage" placeholder="Image">
                    </div>
                    <div class="col-sm-2">
                      <input type="text" class="form-control" name="inputSshuser" placeholder="SSH User">
                    </div>
                  </div>
                {% endif %}
              </div>
              <div class="form-group">
                <div class="col-sm-offset-2 col-sm-8">
                  <button type="button" class="btn-spl btn-default" id="add-provider">Add provider</button>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-offset-2 col-sm-8">
                  <button type="submit" class="btn-spl btn-info">{% if imagetype %} Save {% else %}Create{% endif %}</button>
                </div>
              </div>
            </form>
          </div>
        </div>

      </div>
    </div>
<script data-main="/static/js/createimagetype" src="/static/third_party/require.js"></script>
{% endblock %}
